<div class="container">
  <div class="profile-card">
    <div class="card-header">
      <h2 class="page-title">Technician Information</h2>
      <div class="technician-badge" [class]="'badge-' + currentTechnician.technicianType.toLowerCase()">
        {{ currentTechnician.technicianType }}
      </div>
    </div>

    <form [formGroup]="technicianForm" (ngSubmit)="onSubmit()" class="profile-form">
      
      <div class="photo-section">
        <div class="photo-container">
          <img [src]="currentTechnician.avatar" [alt]="currentTechnician.fullName" class="profile-photo">
          <div class="photo-overlay">
            <input type="file" id="photoInput" (change)="onPhotoChange($event)" accept="image/*" hidden>
            <label for="photoInput" class="change-photo-btn">
              Change Photo
            </label>
          </div>
        </div>
        <p class="photo-note">JPG, PNG max 5MB</p>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="fullName">Full Name</label>
          <input 
            type="text" 
            id="fullName" 
            formControlName="fullName"
            class="form-control"
            [class.error]="technicianForm.get('fullName')?.invalid && technicianForm.get('fullName')?.touched"
          >
          <div class="error-message" *ngIf="technicianForm.get('fullName')?.invalid && technicianForm.get('fullName')?.touched">
            Full name is required (minimum 3 characters)
          </div>
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input 
            type="email" 
            id="email" 
            formControlName="email"
            class="form-control"
            [class.error]="technicianForm.get('email')?.invalid && technicianForm.get('email')?.touched"
          >
          <div class="error-message" *ngIf="technicianForm.get('email')?.invalid && technicianForm.get('email')?.touched">
            Please enter a valid email
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="phone">Phone</label>
          <input 
            type="tel" 
            id="phone" 
            formControlName="phone"
            class="form-control"
            [class.error]="technicianForm.get('phone')?.invalid && technicianForm.get('phone')?.touched"
          >
          <div class="error-message" *ngIf="technicianForm.get('phone')?.invalid && technicianForm.get('phone')?.touched">
            Phone number is required
          </div>
        </div>

        <div class="form-group">
          <label for="completedServices">Completed Services</label>
          <input 
            type="number" 
            id="completedServices" 
            formControlName="completedServices"
            class="form-control"
            readonly
          >
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="specialization">Specialization</label>
          <select id="specialization" formControlName="specialization" class="form-control"
                  [class.error]="technicianForm.get('specialization')?.invalid && technicianForm.get('specialization')?.touched">
            <option value="">Select Specialization</option>
            <option *ngFor="let spec of specializations" [value]="spec">{{ spec }}</option>
          </select>
          <div class="error-message" *ngIf="technicianForm.get('specialization')?.invalid && technicianForm.get('specialization')?.touched">
            Specialization is required
          </div>
        </div>

        <div class="form-group">
          <label for="experience">Experience (Years)</label>
          <input 
            type="number" 
            id="experience" 
            formControlName="experience"
            class="form-control"
            min="0"
            [class.error]="technicianForm.get('experience')?.invalid && technicianForm.get('experience')?.touched"
          >
          <div class="error-message" *ngIf="technicianForm.get('experience')?.invalid && technicianForm.get('experience')?.touched">
            Experience is required
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="hourlyRate">Hourly Rate (EGP)</label>
          <input 
            type="number" 
            id="hourlyRate" 
            formControlName="hourlyRate"
            class="form-control"
            min="50"
            [class.error]="technicianForm.get('hourlyRate')?.invalid && technicianForm.get('hourlyRate')?.touched"
          >
          <div class="error-message" *ngIf="technicianForm.get('hourlyRate')?.invalid && technicianForm.get('hourlyRate')?.touched">
            Hourly rate is required (minimum 50 EGP)
          </div>
        </div>

        <div class="form-group">
          <label for="technicianType">Technician Level</label>
          <select id="technicianType" formControlName="technicianType" class="form-control">
            <option value="Junior">Junior</option>
            <option value="Senior">Senior</option>
            <option value="Expert">Expert</option>
          </select>
        </div>
      </div>

      <div class="form-group full-width">
        <label for="workingArea">Working Area</label>
        <select id="workingArea" formControlName="workingArea" class="form-control">
          <option value="">Select Area</option>
          <option value="Downtown Area">Downtown Area</option>
          <option value="North District">North District</option>
          <option value="South District">South District</option>
          <option value="East District">East District</option>
          <option value="West District">West District</option>
          <option value="Business District">Business District</option>
          <option value="Residential Area">Residential Area</option>
          <option value="Industrial Zone">Industrial Zone</option>
        </select>
      </div>

      <div class="form-group full-width">
        <label for="address">Full Address</label>
        <textarea 
          id="address" 
          formControlName="address"
          class="form-control textarea"
          rows="3"
          placeholder="Enter complete address..."
        ></textarea>
      </div>

      <!-- Technician Stats -->
      <div class="technician-stats">
        <h3>Technician Statistics</h3>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-info">
              <span class="stat-label">Join Date</span>
              <span class="stat-value">{{ currentTechnician.joinDate }}</span>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-info">
              <span class="stat-label">Last Service</span>
              <span class="stat-value">{{ currentTechnician.lastService }}</span>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-info">
              <span class="stat-label">Rating</span>
              <div class="rating-display">
                <span class="stars">
                  <span *ngFor="let star of getStars(currentTechnician.rating)" 
                        [class]="star === 'â˜…' ? 'filled-star' : 'empty-star'">{{ star }}</span>
                </span>
                <span class="rating-value">({{ currentTechnician.rating }})</span>
              </div>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-info">
              <span class="stat-label">Hourly Rate</span>
              <span class="stat-value">{{ currentTechnician.hourlyRate }} EGP</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Certifications -->
      <div class="certifications-section">
        <h3>Certifications</h3>
        <div class="certifications-list">
          <span *ngFor="let cert of currentTechnician.certifications" class="certification-badge">
            {{ cert }}
          </span>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="technicianForm.invalid">
          Update Profile
        </button>
        
        <button type="button" class="btn btn-secondary" (click)="onCancel()">
          Cancel
        </button>
        
        <button type="button" class="btn btn-danger" (click)="onDelete()">
          Delete Technician
        </button>
      </div>
    </form>
  </div>
</div>