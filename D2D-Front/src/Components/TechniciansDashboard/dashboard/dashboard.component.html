
<div class="dashboard-container">
  <!-- Header Section -->
  <div class="header-banner">
    <!-- Left Side: Profile -->
    <div class="profile-section">
      <img src="./assets/technicians-img/tech2.jpg" alt="Profile Image" class="profile-image" />
      <div class="user-info">
        <h2 class="user-name">{{ profile.name }}</h2>
        <p class="user-details">
          ⭐ {{ profile.rating || 0 }} (127 reviews) • {{ profile.totalJobs || 0 }} jobs completed
        </p>
      </div>
    </div>

    <!-- Right Side: Stats + Availability -->
    <div class="header-stats">
      <div class="stat-item">
        <span class="stat-number">${{ profile.earningsToday || 0 }}</span>
        <span class="stat-label">Today</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">${{ profile.earningsWeek || 0 }}</span>
        <span class="stat-label">This Week</span>
      </div>
      <!-- Availability Text in Header -->
      <span 
  class="availability" 
  [ngClass]="{
    'available': availability === 'Available',
    'busy': availability === 'Busy',
    'offline': availability === 'Offline'
  }">
  {{ availability }}
</span>

    </div>
  </div>

  <!-- Navigation Tabs -->
  <div class="nav-tabs">
    <button class="nav-tab" [class.active]="activeTab === 'Dashboard'" (click)="setActiveTab('Dashboard')">
      <i class="fas fa-tachometer-alt"></i>
      Dashboard
    </button>
    <button class="nav-tab" [class.active]="activeTab === 'Jobs'" (click)="setActiveTab('Jobs')">
      <i class="fas fa-wrench"></i>
      Jobs
    </button>

    <button class="nav-tab" [class.active]="activeTab === 'Earnings'" (click)="setActiveTab('Earnings')">
      <i class="fas fa-dollar-sign"></i>
      Earnings
    </button>
    <button class="nav-tab" [class.active]="activeTab === 'Profile'" (click)="setActiveTab('Profile')">
      <i class="fas fa-user-cog"></i>
      Profile
    </button>
  </div>

  <!-- Dashboard Content -->
  <div class="dashboard-content" *ngIf="activeTab === 'Dashboard'">

    <!-- Availability Section -->
    <section class="availability-section">
      <div class="availability-text-block">
        <h3>Availability Status</h3>
        <p>Toggle your availability to receive new jobs</p>
      </div>
      <select [(ngModel)]="availability" class="availability-select">
        <option>Available</option>
        <option>Busy</option>
        <option>Offline</option>
      </select>
    </section>

    <!-- Earnings Summary -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="card-icon money-icon">
          <i class="fas fa-dollar-sign"></i>
        </div>
        <div class="card-content">
          <h3>Today's Earnings</h3>
          <span class="stat-value">${{ profile.earningsToday }}</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="card-icon money-icon">
          <i class="fas fa-wallet"></i>
        </div>
        <div class="card-content">
          <h3>This Week</h3>
          <span class="stat-value">${{ profile.earningsWeek }}</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="card-icon money-icon">
          <i class="fas fa-calendar-alt"></i>
        </div>
        <div class="card-content">
          <h3>This Month</h3>
          <span class="stat-value">${{ profile.earningsMonth }}</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="card-icon services-icon">
          <i class="fas fa-tools"></i>
        </div>
        <div class="card-content">
          <h3>Total Jobs</h3>
          <span class="stat-value">{{ profile.totalJobs }}</span>
        </div>
      </div>
    </div>

    <!-- Today's Schedule -->
    <div class="upcoming-services">
      <h2>Today's Schedule</h2>
      <div class="service-cards" *ngIf="jobsToday.length > 0">
        <div class="service-card" *ngFor="let job of jobsToday">
          <div class="service-details">
            <h4>{{ job.title }}</h4>
            <p>Customer: {{ job.customer }} | Distance: {{ job.distance }}</p>
            <div class="service-meta">
              <span class="time">{{ job.time }}</span>
              <span class="price">${{ job.price }}</span>
            </div>
          </div>
          <div class="service-status">
            <span class="status" [class.accepted]="job.status === 'Accepted'"
              [class.pending]="job.status === 'Pending'">
              {{ job.status }}
            </span>
          </div>
        </div>
      </div>
      <div class="no-services" *ngIf="jobsToday.length === 0">
        <i class="fas fa-calendar-times"></i>
        <p>No jobs scheduled today</p>
      </div>
    </div>

    <!-- Technician Tools -->
    <div class="quick-actions">
      <h2>Quick Actions</h2>
      <div class="action-cards">
        <div class="action-card view-reports" (click)="openReportsModal()">
          <div class="action-icon">
            <i class="fas fa-chart-bar"></i>
          </div>
          <div class="action-content">
            <h3>View Reports</h3>
            <p>Analyze your performance</p>
          </div>
        </div>

        <div class="action-card messages" (click)="openMessagesModal()">
          <div class="action-icon">
            <i class="fas fa-envelope"></i>
          </div>
          <div class="action-content">
            <h3>Messages</h3>
            <p>Check and reply to messages</p>
            <span class="message-badge" *ngIf="unreadMessages > 0">{{ unreadMessages }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Other Tabs -->
  <div class="tab-content" *ngIf="activeTab === 'Jobs'">
    <app-jobs></app-jobs>
  </div>
  <div class="tab-content" *ngIf="activeTab === 'Earnings'">
    <app-earnings></app-earnings>
  </div>
  <div class="tab-content" *ngIf="activeTab === 'Profile'">
    <app-technician-profile></app-technician-profile>
  </div>
</div>

<!-- Reports Modal -->
<div class="modal-overlay" *ngIf="showReportsModal" (click)="closeReportsModal()">
  <div class="modal-container reports-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2><i class="fas fa-chart-bar"></i> Performance Reports</h2>
      <button class="close-btn" (click)="closeReportsModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="modal-content">
      <!-- Performance Overview -->
      <div class="report-section">
        <h3>Performance Overview</h3>
        <div class="report-stats-grid">
          <div class="report-stat">
            <div class="report-icon success">
              <i class="fas fa-thumbs-up"></i>
            </div>
            <div class="report-details">
              <span class="report-value">98%</span>
              <span class="report-label">Customer Satisfaction</span>
            </div>
          </div>
          
          <div class="report-stat">
            <div class="report-icon warning">
              <i class="fas fa-clock"></i>
            </div>
            <div class="report-details">
              <span class="report-value">15 min</span>
              <span class="report-label">Avg Response Time</span>
            </div>
          </div>
        
          
          <div class="report-stat">
            <div class="report-icon success">
              <i class="fas fa-trophy"></i>
            </div>
            <div class="report-details">
              <span class="report-value">127</span>
              <span class="report-label">Jobs Completed</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Monthly Breakdown -->
      <div class="report-section">
        <h3>Monthly Breakdown</h3>
        <div class="monthly-stats">
          <div class="month-item">
            <span class="month">January</span>
            <div class="progress-bar">
              <div class="progress" style="width: 85%"></div>
            </div>
            <span class="month-value">$5,420</span>
          </div>
          <div class="month-item">
            <span class="month">February</span>
            <div class="progress-bar">
              <div class="progress" style="width: 92%"></div>
            </div>
            <span class="month-value">$5,890</span>
          </div>
          <div class="month-item">
            <span class="month">March</span>
            <div class="progress-bar">
              <div class="progress" style="width: 78%"></div>
            </div>
            <span class="month-value">$4,980</span>
          </div>
        </div>
      </div>

      <!-- Top Services -->
      <div class="report-section">
        <h3>Top Services</h3>
        <div class="top-services">
          <div class="service-item">
            <div class="service-info">
              <span class="service-name">Oil Change & Filter</span>
              <span class="service-count">45 times</span>
            </div>
            <span class="service-earnings">$2,925</span>
          </div>
          <div class="service-item">
            <div class="service-info">
              <span class="service-name">Brake Inspection</span>
              <span class="service-count">32 times</span>
            </div>
            <span class="service-earnings">$2,720</span>
          </div>
          <div class="service-item">
            <div class="service-info">
              <span class="service-name">Engine Diagnostic</span>
              <span class="service-count">28 times</span>
            </div>
            <span class="service-earnings">$4,200</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Messages Modal -->
<div class="modal-overlay" *ngIf="showMessagesModal" (click)="closeMessagesModal()">
  <div class="modal-container messages-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2><i class="fas fa-envelope"></i> Messages</h2>
      <button class="close-btn" (click)="closeMessagesModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="modal-content">
      <div class="messages-list">
        <div class="message-item unread" *ngFor="let message of messages">
          <div class="message-avatar">
            <img [src]="message.avatar" [alt]="message.sender">
            <div class="online-status" *ngIf="message.isOnline"></div>
          </div>
          <div class="message-content">
            <div class="message-header">
              <span class="sender-name">{{ message.sender }}</span>
              <span class="message-time">{{ message.time }}</span>
            </div>
            <div class="message-preview">{{ message.preview }}</div>
            <div class="message-meta">
              <span class="message-type" [ngClass]="message.type">{{ message.typeLabel }}</span>
            </div>
          </div>
          <div class="message-actions">
            <button class="action-btn reply" title="Reply" (click)="replyToMessage(message.id)">
              <i class="fas fa-reply"></i>
            </button>
          </div>
        </div>
      </div>
      
      <div class="messages-footer">
        <button class="btn-secondary" (click)="markAllAsRead()">
          <i class="fas fa-check-double"></i> Mark All Read
        </button>
      </div>
    </div>
  </div>
</div>